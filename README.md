## A new approach to classify, separate and enrich objects in groups using ensemble sorting

Rebecca Turk-MacLeodǂ, Alon B. Hensonǂ, Marc Rodriguez-Garcia, Graham M. Gibson, Miles J. Padgett, Leroy Cronin*

\* Corresponding author

ǂ These authors contributed equally to this work

**Abstract**

The sorting of objects into groups is a fundamental operation, critical in the preparation and purification of populations of cells, crystals, beads, or droplets, necessary for research and applications in biology, chemistry and materials science. Most of the efforts exploring such purification have focused on two areas: the degree of separation and the measurement precision required for effective separation. Conventionally, achieving good separation ultimately requires that the objects are considered one by one (which can be both slow and expensive), and the ability to measure the sorted objects by increasing sensitivity as well as reducing sorting errors. Here we present an alternative approach to sorting that addresses both of these critical limitations with a scheme that allows us to approach the theoretical limit for the accuracy of sorting decisions.  Rather than sorting individual objects, we conduct the sorting of objects in ensembles, via a set of registers which are then in turn sorted themselves into a second symmetric set of registers. By repeating this process, we can arrive at high sorting purity with a low set of constraints. We demonstrate both the theory behind this idea and identify the critical parameters (ensemble population and sorting time), and we demonstrate the utility and robustness of our method with simulations and experimental systems spanning several orders of scale, sorting populations of macroscopic beads and microfluidic droplets. Our method is general in nature and greatly simplifies the sorting process, and thus stands to enhance many different areas of science, such as purification, enrichment of rare objects,and separation of dynamic populations. 

**Links**

DOI:  [10.1073/pnas.1721929115](https://doi.org/10.1073/pnas.1721929115)

The jupyter notebook contains the code to run simulations and plot the results. 

The pickles folder contains pickled simulation results.

code has been tested with the following package versions

- numpy 1.12.1


- scipy 0.19.0

- pandas 0.20.1

- matplotlib 2.0.1

  ​
